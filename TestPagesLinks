require 'selenium-webdriver'
require './StandartPage'

service = Selenium::WebDriver::Service.chrome(path:'.\drivers\chromedriver.exe')

driver = Selenium::WebDriver.for :chrome, service: service
baseUrl = 'http://qa-web-test-task.s3-website.eu-central-1.amazonaws.com/'

driver.get baseUrl
print driver.current_url

pages = Array.new
numPage = 8540

while !(pages.find {|item| item.is_last == true}) do
  currentPage = StandartPage.new(driver)
  currentPage.setPage numPage
  currentPage.set_has_link
  pages << currentPage
  if !(currentPage.has_link)
    currentPage.set_is_last
  end
  numPage += 1
  driver.get(baseUrl + numPage.to_s + ".html")
end

result = pages.select { |page| page.has_link == false }
result.each { |page|
  puts("Page #{page.page_number} has link = #{page.has_link} is last = #{page.is_last}")
}

driver.quit